<html layout:decorate="~{layout}">
<head>
    <style>
        .ProseMirror {
            font-size:20px;
            font-family: 'nanum-regular';
        }

        .toastui-editor-contents {
            font-size:20px;
            font-family: 'nanum-regular';
        }
    </style>
</head>
<div layout:fragment="content" class="container my-3">
    <h3 class="my-3 border-bottom pb-2">공지 사항</h3>
    <form method="post" id="announcementForm">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <div class="mb-3">
            <label for="title" class="form-label">제목</label>
            <input type="text" class="form-control" name="title" id="title" th:value="${announcement} ? ${announcement.title} : ''">
        </div>
        <div class="mb-3">
            <label for="content" class="form-label">내용</label>
            <input type="hidden" name="content" id="content" th:value="${announcement} ? ${announcement.content} : ''">
            <div id="editor"></div>
        </div>
        <div class="d-flex justify-content-end">
            <input type="button" class="btn 버튼-full" value="등록" id="regBtn">
        </div>
    </form>
</div>
<script type="text/javascript" layout:fragment="script">
    $(function() {
        const editor = new toastui.Editor({
            el: $('#editor')[0],
            height: '500px',
            initialEditType: 'markdown',
            previewStyle: 'vertical'
        });

        const content = $('#content').val();
        editor.setMarkdown(content);

        $('#regBtn').on('click', function() {
            const markdown = editor.getMarkdown();
            $('#content').val(markdown);
            if ($('#title').val() == '') {
                alert('제목을 입력해주세요.');
            } else if ($('#content').val() == '') {
                alert('내용을 입력해주세요.');
            } else {
                $('#announcementForm').submit();
            }
        });
    });
</script>
</html>