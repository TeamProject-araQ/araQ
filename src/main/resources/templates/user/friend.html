<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <h3 class="underline-start my-3">친구 요청</h3>
    <table class="table table-hover text-center">
        <thead>
        <tr>
            <th>성별</th>
            <th>닉네임</th>
            <th>수락/거절</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="request : ${requestList}">
            <td>
                <img src="/image/user/man.png" alt="" style="width: 20px; height: 20px;"
                     th:if="${request.sender.gender == '남성'}">
                <img src="/image/user/woman.png" alt="" style="width: 20px; height: 20px;"
                     th:if="${request.sender.gender == '여성'}">
            </td>
            <td>
                <a th:text="${request.sender.nickName}" type="button" href="javascript:void(0)" class="viewProfile"></a>
            </td>
            <td></td>
        </tr>
        </tbody>
    </table>
    <h3 class="underline-start my-3">친구 목록</h3>
    <table class="table table-hover text-center">
        <thead class="table-light">
        <tr>
            <th>성별</th>
            <th>닉네임</th>
            <th>활동 상태</th>
            <th>삭제</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="friend : ${friendList}">
            <td>
                <div th:if="${friend.receiver != user}">
                    <img src="/image/user/man.png" alt="" style="width: 20px; height: 20px;"
                         th:if="${friend.receiver.gender == '남성'}">
                    <img src="/image/user/woman.png" alt="" style="width: 20px; height: 20px;"
                         th:if="${friend.receiver.gender == '여성'}">
                </div>
                <div th:if="${friend.sender != user}">
                    <img src="/image/user/man.png" alt="" style="width: 20px; height: 20px;"
                         th:if="${friend.sender.gender == '남성'}">
                    <img src="/image/user/woman.png" alt="" style="width: 20px; height: 20px;"
                         th:if="${friend.sender.gender == '여성'}">
                </div>
            </td>
            <td>
                <div th:if="${friend.sender != user}" th:text="${friend.sender.nickName}"></div>
                <div th:if="${friend.receiver != user}" th:text="${friend.receiver.nickName}"></div>
            </td>
            <td>
                <div th:if="${friend.receiver != user}">
                    <div th:if="${friend.receiver.login}">
                        <img th:src="@{${friend.receiver.image}}" alt="" style="width: 30px; height: 30px;">
                        <span class="ms-1">온라인</span>
                    </div>
                    <div th:if="${!friend.receiver.login}">
                        <img th:src="@{${friend.receiver.image}}" alt=""
                             style="opacity: 0.3; width: 30px; height: 30px;">
                        <span class="ms-1">오프라인</span>
                    </div>
                </div>
                <div th:if="${friend.sender != user}">
                    <div th:if="${friend.sender.login}">
                        <img th:src="@{${friend.sender.image}}" alt="" style="width: 30px; height: 30px;">
                        <span class="ms-1">온라인</span>
                    </div>
                    <div th:if="${!friend.sender.login}">
                        <img th:src="@{${friend.sender.image}}" alt=""
                             style="opacity: 0.3; width: 30px; height: 30px;">
                        <span class="ms-1">오프라인</span>
                    </div>
                </div>
            </td>
            <td>
                <div th:if="${friend.sender != user}"><a href="javascript:void(0)" type="button"
                                                         th:data-value="${friend.sender.nickName}"
                                                         th:data-uri="@{|/friend/delete/${friend.sender.username}|}"
                                                         class="deleteFriend btn btn-danger btn-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor"
                         class="bi bi-x-lg"
                         viewBox="0 0 16 16">
                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                    </svg>
                </a>
                </div>
                <div th:if="${friend.receiver != user}"><a href="javascript:void(0)" type="button"
                                                           th:data-value="${friend.receiver.nickName}"
                                                           th:data-uri="@{|/friend/delete/${friend.receiver.username}|}"
                                                           class="deleteFriend btn btn-danger btn-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor"
                         class="bi bi-x-lg"
                         viewBox="0 0 16 16">
                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                    </svg>
                </a>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>
<script layout:fragment="script">
    $(function () {
        $('.deleteFriend').on('click', function () {
            var friendNick = $(this).data("value");
            if (confirm(friendNick + "님을 친구 목록에서 삭제하시겠습니까?"))
                location.href = $(this).data("uri");
        });
    });

    $(".viewProfile").on('click', function () {
        showProfile($(this).data("value"));
    });
</script>
</html>